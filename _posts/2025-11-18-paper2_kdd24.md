---
title: "UrbanGPT: Spatio-Temporal Large Language Models."
date: 2025-11-18
permalink: /posts/2025/11/paper2_kdd24/
categories: [论文阅读]
tags: [时空预测, LLM, 城市计算]
excerpt: "时空预测大模型"
---

Zhonghang Li, Lianghao Xia, Jiabin Tang, Yong Xu, Lei Shi, Long Xia, Dawei Yin, and Chao Huang. 2024. UrbanGPT: Spatio-Temporal Large Language Models. In Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (KDD ’24), August 25–29, 2024, Barcelona, Spain. ACM, New York, NY, USA, 12 pages. [https://doi.org/10.1145/3637528.3671578](https://doi.org/10.1145/3637528.3671578). Code:[https://github.com/HKUDS/UrbanGPT.](https://github.com/HKUDS/UrbanGPT.)

# UrbanGPT: Spatio-Temporal Large Language Models(时空大模型)

## 动机 :shit:

时空预测在洞察城市环境的动态变化上具有独特的优势，当前存在的问题主要有城市传感场景中的数据**具有高度的稀疏性**，以此训练出来的神经网络模型无法为下游任务提供准确的指导。

LLM在推理及抽象上具有独特的优势，希望借助大模型实现在**无标签或少标签**的情况下进行准确额时空预测，以实现不同场景下较高的模型泛化能力。

***核心立意是数据稀疏问题。***

![先导实验，对比不同方法预测出租车流量预测结果]({{ "/images/paper2xiandaotu.png" | relative_url }})

## 基础概念

1. 时空数据: 定义为 $X \in \mathbb{R}^{R × T × F}$ 是一个三维张量， $X_{r,t,f}$ 表示在区域r，时间t时第f个特征的值。

2. 时空预测：已知历史H个时间段的信息，预测未来P个时间段的数据：
   $$
   X_{t_{K+1}:t_{K+P}}=f(X_{t_{K-H+1}:t_{K}})
   $$
   包含两类预测预测任务：回归和分类。

3. 时空零样本学习：
   $$
   \hat{X}_{t_{K+1}:t_{K+P}}=\hat{f}(\hat{X}_{t_{K-H+1}:t_{K}})
   $$   
   模型 $\hat{f}$ 不是专门针对目标数据训练的。

## 总体结构

![总体结构]({{ "/images/paper2jiegoutu.png" | relative_url }})

### 时间编码器 :sweat_smile:

采用门控扩张卷积和多级相关注入层（说的太简单了），通过门控扩张卷积提取不同粒度下的时间特征，再通过多级相关注入层融合不同尺度的特征。

### 时空指令微调

#### 时空文本对齐

时间特征和空间特征的维度不同，通过轻量级映射模块将时空特征映射到相同的维度。（全连接层）轻量级（笑:sweat_smile:）

时空令牌：把“时空数据片段”变成类似文字 token 的向量，让 LLM 可以像读文字一样读懂时空数据。
类似如下方式：
```python
Token 1 = 0 点 A 区的 PM2.5+其它特征（映射成4096维）
Token 2 = 0 点 B 区......
Token 3 = 0 点 C 区......
...
Token 24 = 1 点 A 区......
...
Token 120 = 23 点 E 区......

```

#### 时空提示指令

微调指令格式：
![微调文本]({{ "/images/paper2weitiaowenben.png" | relative_url }})

### 时空指令微调

生成预测令牌，然后通过回归层映射隐藏表示以生成更准确的预测值。监督微调

回归任务：
$$
\mathbf{Y}_{r,f} = \mathbf{W}_3 \left[ \sigma(\mathbf{W}_1 \mathbf{H}_{r,f}),\; \sigma(\mathbf{W}_2 \mathbf{\Gamma}_{r,f}) \right]
$$
，其中 $\mathbf{\Gamma}_{r,f}$ 作为新术语纳入LLM的词汇表中。

## 损失函数

采用了绝对误差损失所谓回归任务函数，
将分类任务的损失也纳入进来。联合损失。

## 实验评估

指标：回归任务采用MAE和RMSE，分类任务采用召回率和宏F1分数。

数据集：NYC-taxi，NYC-bike，NYC-crime，跨城市预测采用了CHI-taxi

![实验表 含回归与分类任务]({{ "/images/paper2shiyanbiao.png" | relative_url }})

## 案例研究

![案例]({{ "/images/paper2case1.png" | relative_url }})

![案例]({{ "/images/paper2case2.png" | relative_url }})

## 总结

1. 没有本质创新，采用了门控扩张卷积和多级相关性注入层联合提取时空潜在特征。
2. 针对时空预测这个新问题提出全新LLM框架。尤其是零样本学习。
3. 其他的更多的是现有成熟技术的整合。